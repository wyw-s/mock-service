import{C as N}from"./CodeMirror.b7ed99dc.js";import{a as z,h as x,b as L,d as S}from"./index.559accac.js";import{_ as V,E as f,r as l,o as M,c as j,a as e,w as n,e as h,F as U,f as T,b as i,t as m}from"./index.b44ea885.js";const B={name:"InterfaceList",components:{CodeMirror:N},data(){return{interfaceList:[],drawer:!1,code:"",row:{},pagination:{pageNum:1,pageSize:10,total:0},interfaceName:""}},mounted(){this.getInterfaceList()},methods:{getInterfaceList(){z({pageNum:this.pagination.pageNum,pageSize:this.pagination.pageSize,interfaceName:this.interfaceName}).then(t=>{this.pagination.total=t.data.total||0,this.interfaceList=t.data.list})},onAdd(){this.$router.push("/interface/add")},onlineTest(t){this.drawer=!0,this.row={...t,envUrl:`${window.location.origin}/8mock/${t.projectId}`},x.get(`/8mock/${t.projectId}${t.url}`).then(o=>{this.code=JSON.stringify(o,null,2)})},onModify(t){this.$router.push({path:"/interface/add",query:{mockId:t.id}})},onCopy(t){L({projectId:t.projectId,name:t.name,url:`${t.url}/copy-${Math.floor(Math.random()*1e5)}`,response:t.response,remark:t.remark}).then(o=>{o.success&&(f({message:"\u590D\u5236\u6210\u529F",type:"success"}),this.getInterfaceList())})},onDel(t){S({id:t.id}).then(o=>{o.success&&(f({message:"\u5220\u9664\u6210\u529F",type:"success"}),this.getInterfaceList())})},handleSizeChange(t){this.pagination.pageSize=t,this.getInterfaceList()},handleCurrentChange(t){this.pagination.pageNum=t,this.getInterfaceList()},onSearch(){this.getInterfaceList()}}},D={class:"pagination-block"},E={style:{height:"calc(100% - 160px)"}};function K(t,o,A,F,a,s){const g=l("el-input"),p=l("el-space"),w=l("el-button"),c=l("el-table-column"),d=l("el-link"),y=l("el-table"),C=l("el-pagination"),u=l("el-descriptions-item"),b=l("el-descriptions"),k=l("el-card"),v=l("CodeMirror"),I=l("el-drawer");return M(),j(U,null,[e(p,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[e(p,null,{default:n(()=>[e(g,{placeholder:"\u8BF7\u8F93\u5165\u63A5\u53E3\u540D\u79F0",modelValue:a.interfaceName,"onUpdate:modelValue":o[0]||(o[0]=r=>a.interfaceName=r),onKeyup:T(s.onSearch,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(p,null,{default:n(()=>[e(w,{type:"primary",onClick:s.onAdd},{default:n(()=>[i(" \u65B0\u589E ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(y,{data:a.interfaceList,"max-height":"500","row-key":"id","highlight-current-row":""},{default:n(()=>[e(c,{prop:"name",label:"\u63A5\u53E3\u540D\u79F0",width:"180","show-overflow-tooltip":""}),e(c,{prop:"url",label:"URL","show-overflow-tooltip":""}),e(c,{prop:"projectName",label:"\u9879\u76EE\u540D\u79F0",width:"180","show-overflow-tooltip":""}),e(c,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4",width:"180"}),e(c,{prop:"remark",label:"\u5907\u6CE8",width:"220","show-overflow-tooltip":""}),e(c,{prop:"opt",label:"\u64CD\u4F5C",width:"180"},{default:n(r=>[e(p,null,{default:n(()=>[e(d,{type:"primary",onClick:_=>s.onlineTest(r.row)},{default:n(()=>[i(" \u9884\u89C8 ")]),_:2},1032,["onClick"]),e(d,{type:"primary",onClick:_=>s.onCopy(r.row)},{default:n(()=>[i(" \u590D\u5236 ")]),_:2},1032,["onClick"]),e(d,{type:"primary",onClick:_=>s.onModify(r.row)},{default:n(()=>[i(" \u4FEE\u6539 ")]),_:2},1032,["onClick"]),e(d,{type:"danger",onClick:_=>s.onDel(r.row)},{default:n(()=>[i(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"]),h("div",D,[e(C,{"current-page":a.pagination.pageNum,"page-size":a.pagination.pageSize,"page-sizes":[10,20,40,100],background:"background",layout:"total, prev, pager, next, sizes",total:a.pagination.total,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),e(I,{size:"50%",modelValue:a.drawer,"onUpdate:modelValue":o[2]||(o[2]=r=>a.drawer=r),"with-header":!1,direction:"ltr"},{default:n(()=>[e(k,{shadow:"always",style:{"margin-bottom":"16px"}},{default:n(()=>[e(b,{column:"2"},{default:n(()=>[e(u,{label:"\u63A5\u53E3\u540D\u79F0\uFF1A"},{default:n(()=>[i(m(a.row.name),1)]),_:1}),e(u,{label:"\u9879\u76EE\u540D\u79F0\uFF1A"},{default:n(()=>[i(m(a.row.projectName),1)]),_:1}),e(u,{label:"URL\uFF1A",span:"2"},{default:n(()=>[i(m(a.row.url),1)]),_:1}),e(u,{label:"\u73AF\u5883\u5730\u5740\uFF1A",span:"2"},{default:n(()=>[i(m(a.row.envUrl),1)]),_:1})]),_:1})]),_:1}),h("div",E,[e(v,{modelValue:a.code,"onUpdate:modelValue":o[1]||(o[1]=r=>a.code=r)},null,8,["modelValue"])])]),_:1},8,["modelValue"])],64)}const O=V(B,[["render",K],["__scopeId","data-v-fab4def9"]]);export{O as default};
